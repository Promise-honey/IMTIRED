@using IMTIRED.Utilities
@using IMTIRED.Services
@inject UserSession UserSession
@inject CustomerService CustomerService

@rendermode InteractiveServer

@page "/modify"

<h3>Modify Account</h3>

<p>New password</p>
<input @bind-value="@newPassword" />
<p>Old password</p>
<input @bind-value="@oldPassword" />
<p>Confirm old password</p>
<input @bind-value="@oldPasswordConfirm" />
<button @onclick="ChangePassword">Change Password</button>

@code {
    private string newPassword;
    private string oldPassword;
    private string oldPasswordConfirm;

    private async Task ChangePassword()
    {
        if (oldPassword == oldPasswordConfirm)
        {
            string hashedNewPassword = PasswordUtils.HashPassword(newPassword);
            string hashedOldPassword = PasswordUtils.HashPassword(oldPassword);
            await CustomerService.ChangePassword(UserSession.UserId, hashedOldPassword, hashedNewPassword);
        }
    }
}
